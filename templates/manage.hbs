{{> header title="Manage" }}

<nav class="light-blue lighten-1" role="navigation" xmlns:v-on="http://www.w3.org/1999/xhtml">
    <div class="nav-wrapper container">
        <a id="logo-container" href="#" class="brand-logo">Liftpush</a>
        <ul id="nav-mobile" class="right">
            <li class="hide-on-med-and-down">Hello {{username}}</li>
            <li><a href="logout">Logout</a></li>
        </ul>
    </div>
</nav>

<div class="section" id="index-banner">
    <div class="container">
        <br><br>

        <div class="row">
            <div class="col s12 m8">
                <ul class="collection">
                    <!--{{#each files as |f| ~}}
                        <li class="collection-item" data-url="{{ f.name }}"
                            data-target="{{ f.meta.url }}"
                            data-name="{{ f.meta.actual_filename }}"
                            data-upload-name="{{ f.meta.filename }}" data-type="{{ f.meta.type }}">
                            {{#if f.meta.actual_filename}}
                                {{ f.meta.actual_filename }}
                            {{else}}
                                {{ f.name }} &rarr; {{ f.meta.url }}
                            {{/if}}
                        </li>
                    {{/each~}}-->
                    <li class="collection-item" v-for="item in items" v-on:click="active_item = item"
                        :class="{ active: active_item && active_item == item }">
                        <span v-if="item.meta.actual_filename">
                            \{{ item.meta.actual_filename }}
                        </span>
                        <span v-else>
                            \{{ item.name }} &rarr; \{{ item.meta.url }}
                        </span>
                        <!--\{{#if f.meta.actual_filename}}
                            \{{ f.meta.actual_filename }}
                        \{{else}}
                        \{{/if}}-->
                    </li>
                </ul>
            </div>

            <div class="col s12 m4">
                <div class="card" id="file-holder">
                    <div class="card-image" id="file-src" v-if="active_item"
                         v-bind:style="`display:block;background-image: url(` + active_item.name + `)`"></div>
                    <div class="card-image" id="file-src" v-else></div>
                    <div class="card-content">
                        <span class="card-title black-text" id="file-name">
                            <span v-if="active_item">
                                <span v-if="active_item.meta.actual_filename">
                                    \{{ active_item.meta.actual_filename }}
                                </span>
                                <span v-else>
                                    \{{ item.name }} &rarr; \{{ item.meta.url }}
                                </span>
                            </span>
                            <span v-else>
                                Select an item.
                            </span>
                        </span>
                        <p id="file-meta">
                            <span v-if="active_item">
                                \{{ active_item.meta.filename }},
                                type: \{{ active_item.meta.type }}
                            </span>
                        </p>
                    </div>
                    <div class="card-action" v-if="active_item">
                        <a href="#deleteModal" class="red-text modal-trigger">Delete</a>
                        <a v-bind:href="active_item.name" target="_blank" id="file-open">Open</a>
                        <a href="#renameModal" class="modal-trigger">Rename</a>
                    </div>
                </div>
            </div>
        </div>

        <br><br>
    </div>

    <div id="deleteModal">
        <div class="modal-content" v-if="active_item">
            <h4>Delete file</h4>
            <p>Are you sure you want to delete \{{ active_item.name }}?</p>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Cancel</a>
            <a href="#!" id="delete-file-button" v-on:click="deleteFile"
               class="modal-action modal-close waves-effect waves-red btn-flat red-text">OK</a>
        </div>
    </div>

    <div id="renameModal">
        <div class="modal-content" v-if="active_item">
            <h4>Rename file</h4>
            <p>Rename \{{ active_item.name }} to what?</p>
            <div class="input-field">
                <input id="rename-modal-target" type="text" class="validate" v-model="rename_value">
                <label for="rename-modal-target">New Name (excluding extension)</label>
            </div>
        </div>
        <div class="modal-footer">
            <a href="#!" class="modal-action modal-close waves-effect waves-green btn-flat">Cancel</a>
            <a href="#!" v-on:click="renameFile"
               class="modal-action modal-close waves-effect waves-green btn-flat green-text">OK</a>
        </div>
    </div>
</div>

{{> scripts }}

<script type="text/javascript" src="js/vue.min.js"></script>
<script type="text/javascript" src="js/manage.js"></script>

{{> footer }}
